/* Fixes for specific issues */

/* Fix #1: Ensure circular star map shape for large dimensions */
#star-map-canvas {
    max-width: 100% !important;
    height: auto !important;
    display: block !important;
    margin: 0 auto !important;
    aspect-ratio: 1 / 1 !important; /* Force 1:1 aspect ratio for the canvas */
    border-radius: 50% !important; /* Ensure circular shape */
    transform-origin: center !important;
    transform: none !important; /* Prevent any transforms */
    overflow: hidden !important; /* Hide overflow */
}

/* Fix for circular star map in preview - prevent nested circles */
.circular-starfield-container {
    position: relative !important;
    width: 100% !important;
    height: auto !important;
    aspect-ratio: 1 / 1 !important;
    display: block !important; /* Changed from flex to block */
    margin: 0 auto !important; /* Center the container */
    border-radius: 50% !important; /* Make container circular */
    overflow: hidden !important; /* Hide overflow */
}

/* Fix #2: Reduce padding between Date and Coordinates rows */
.fixed-text-styling .text-entry-wrapper {
    margin-bottom: 0 !important; /* Reduced from 20px to 0 */
    padding-bottom: 0 !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important; /* Center the content */
    flex-wrap: nowrap !important;
    width: 100% !important; /* Ensure full width */
}

.fixed-text-styling .text-entry-wrapper:first-child {
    margin-bottom: 5px !important; /* Small gap between Date and Coordinates */
}

/* Fix for Date and Coordinates label alignment */
.fixed-text-styling .text-entry-wrapper label {
    min-width: 90px !important; /* Fixed width for both labels */
    text-align: right !important; /* Right-align the text */
    margin-right: 10px !important;
    white-space: nowrap !important;
    display: inline-block !important;
}

/* Center the Fixed Text Styling container */
.fixed-text-styling {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important; /* Center horizontally */
    justify-content: center !important;
    width: 100% !important;
    margin: 0 auto !important; /* Center the container */
}

/* Fix #3 & #4: Fix coordinate fields layout */
.manual-coordinates {
    display: flex !important;
    flex-wrap: nowrap !important; /* Prevent wrapping */
    gap: 2px !important;
    align-items: center !important;
    justify-content: flex-start !important;
    max-width: 100% !important;
}

.manual-coordinates label {
    margin-right: 2px !important;
    white-space: nowrap !important;
    flex-shrink: 0 !important;
    padding-right: 2px !important;
}

/* Right-align Zip/Postal Code label */
.manual-coordinates label[for="zip-code"], .zip-code-label {
    text-align: right !important;
    margin-right: 0 !important;
    padding-right: 2px !important;
    margin-left: auto !important; /* Push to the right */
}

.manual-coordinates input {
    width: 150px !important;
    max-width: 150px !important;
    min-width: 150px !important;
    margin-right: 10px !important;
    flex-shrink: 0 !important;
    box-sizing: border-box !important;
}

#latitude, #longitude {
    width: 150px !important;
    max-width: 150px !important;
    min-width: 150px !important;
}

#zip-code {
    width: 150px !important;
    max-width: 150px !important;
    min-width: 150px !important;
}

/* Fix #5: Ensure all font sizes are visible in dropdowns */
.font-size-select, .font-family-select {
    width: auto !important;
    min-width: 70px !important;
    max-width: none !important;
}

.font-size-select option, .font-family-select option {
    display: block !important;
    visibility: visible !important;
}

/* Fix for font family dropdowns in Fixed Text Styling */
.fixed-text-styling .font-family-select {
    width: 120px !important;
    max-width: 120px !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
}

/* Additional styling to ensure proper layout */
.font-controls {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 5px !important;
    align-items: center !important;
}

/* Fix for SVG star rendering */
.star-field-svg {
    fill: currentColor !important;
}

/* Fix for character count positioning - move after font size field */
.char-count {
    position: static !important; /* Remove absolute positioning */
    display: inline-block !important;
    vertical-align: middle !important;
    margin-left: 0 !important;
    margin-right: 10px !important;
    padding-left: 0 !important;
    order: 2 !important; /* Position after font size */
}

.text-entry-wrapper {
    position: relative !important;
    display: flex !important;
    align-items: center !important;
}

.text-entry {
    padding-right: 5px !important; /* Reduce padding since count is no longer inside */
}

/* Remove extra line breaks after container labels */
.input-section {
    margin-bottom: 5px !important;
}

.input-section + div {
    margin-top: 0 !important;
    padding-top: 5px !important;
}

/* Fix for font scaling in downloaded images */
@media print {
    #star-map-canvas text {
        font-size: calc(attr(font-size) * 1.5) !important;
    }
}

/* Improve ZIP code dropdown */
#zip-code-history {
    width: 100% !important;
}

/* Right-click menu for ZIP code history */
.context-menu {
    position: absolute !important;
    background-color: white !important;
    border: 1px solid #ccc !important;
    box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2) !important;
    z-index: 1000 !important;
    padding: 5px 0 !important;
}

.context-menu-item {
    padding: 5px 10px !important;
    cursor: pointer !important;
}

.context-menu-item:hover {
    background-color: #f0f0f0 !important;
}

/* Fix for font family dropdowns */
.font-family-select {
    text-overflow: ellipsis !important;
}

/* Fix for text layer container spacing */
#text-layer-container {
    padding-top: 5px !important;
    padding-bottom: 5px !important;
}

/* Fix for image options container spacing */
.image-options {
    padding-top: 5px !important;
    margin-top: 0 !important;
}

/* Fix for grouped sections container spacing */
.grouped-sections-container {
    margin-bottom: 10px !important;
    border: 1px solid #ccc !important; /* Add border */
    border-radius: 5px !important;
    padding: 10px !important;
}

/* Fix for font controls layout */
.font-controls {
    display: flex !important;
    flex-wrap: wrap !important; /* Allow wrapping on smaller screens if needed */
    justify-content: flex-start !important;
    width: 100% !important;
    align-items: center !important;
}

.font-controls > * {
    flex-shrink: 1 !important;
}

.font-controls .font-family-select {
    flex-grow: 2 !important;
    max-width: 40% !important;
    order: 0 !important;
}

.font-controls .font-size-select {
    flex-grow: 0 !important;
    max-width: 15% !important;
    order: 1 !important;
    margin-right: 0 !important; /* No margin after font size */
}

.font-controls .style-options {
    flex-grow: 1 !important;
    display: flex !important;
    white-space: nowrap !important;
    max-width: 30% !important;
    align-items: center !important;
    order: 3 !important; /* After char count */
}

.font-controls .font-color-picker {
    flex-grow: 0 !important;
    max-width: 10% !important;
    order: 4 !important;
}

/* Fix for section containers */
.grouped-sections-container {
    margin-bottom: 15px !important;
    border: 1px solid #ccc !important;
    border-radius: 5px !important;
    padding: 10px !important;
}

/* Fix for font size dropdowns */
select.font-size-select {
    width: 70px !important;
    min-width: 70px !important;
}

select.font-size-select option {
    display: block !important;
    visibility: visible !important;
}

/* Fix for preview mode star map */
#star-map-canvas {
    border-radius: 50% !important;
    overflow: hidden !important;
    transform: none !important;
}

/* Fix for container nesting */
.input-section > div {
    padding: 5px !important;
}

/* Fix for ZIP code right-click */
.zip-code-container {
    position: relative !important;
}

/* Fix for font scaling in large dimensions */
@media (min-width: 2000px) {
    #star-map-canvas text {
        font-size: 1.5em !important;
    }
}

/* Fix for coordinates label */
.coordinates-label {
    min-width: 90px !important;
    white-space: nowrap !important;
    overflow: visible !important;
    text-overflow: clip !important;
    text-align: right !important; /* Right-align the text */
}

/* Fix for style options alignment */
.style-options {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
}

.style-options label {
    display: flex !important;
    align-items: center !important;
    margin: 0 5px !important;
}

/* Fix for zoom slider */
.zoom-container {
    margin-bottom: 10px !important;
}

/* Fix for download button */
.download-section {
    margin-bottom: 10px !important;
}

/* Fix for canvas container */
.canvas-container {
    width: 100% !important;
    height: auto !important;
    aspect-ratio: 1 / 1 !important;
}

/* Fix for text entry wrapper layout */
.text-entry-wrapper {
    margin-bottom: 10px !important;
    display: flex !important;
    align-items: center !important;
}

.text-entry-wrapper label {
    margin-right: 5px !important;
    white-space: nowrap !important;
}

.text-entry-wrapper .text-entry {
    flex-grow: 1 !important;
    margin-right: 5px !important;
}

/* Fix for font size dropdown in text layers */
#font-size-1, #font-size-2, #font-size-3 {
    width: 70px !important;
    min-width: 70px !important;
}

/* Fix for ZIP code history dropdown */
#zip-code-history option {
    display: block !important;
    visibility: visible !important;
}

/* Fix for ZIP code dropdown */
.zip-dropdown-list {
    max-height: 200px !important;
    overflow-y: auto !important;
    background-color: white !important;
    border: 1px solid #ccc !important;
    z-index: 1000 !important;
}

.zip-dropdown-item {
    padding: 5px 10px !important;
    cursor: pointer !important;
}

.zip-dropdown-item:hover {
    background-color: #f0f0f0 !important;
}

/* Fix for star map scaling */
#star-map-canvas {
    transform: scale(1) !important;
}

/* Fix for circular star map - prevent nested circles */
.circular-starfield-container #star-map-canvas {
    position: relative !important;
    width: 100% !important;
    height: auto !important;
    aspect-ratio: 1 / 1 !important;
    border-radius: 50% !important;
    transform: scale(1) !important;
}

/* Fix for default dimensions */
#output-width {
    width: 80px !important;
}

#output-height {
    width: 80px !important;
}

/* Fix for nested circles in preview */
.circular-starfield-container .circular-starfield-container {
    display: none !important; /* Hide nested containers */
}

/* Fix for oval star map in preview */
#star-map-canvas, .circular-starfield-container {
    aspect-ratio: 1 / 1 !important; /* Force perfect circle */
    width: 100% !important;
    height: 0 !important; /* Let aspect-ratio control the height */
    padding-bottom: 100% !important; /* Create a square */
    box-sizing: border-box !important;
}

/* Fix for Fixed Text Styling container alignment */
.fixed-text-styling {
    margin: 0 auto !important;
    text-align: center !important;
    width: 100% !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
}

/* Fix for Date and Coordinates rows alignment */
.fixed-text-styling .text-entry-wrapper {
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
    width: auto !important; /* Let content determine width */
    margin: 0 auto !important; /* Center horizontally */
}

/* --- NEW FIXES (Appended) --- */

/* Prevent wrapping in text layer controls */
.text-entry-wrapper {
    flex-wrap: nowrap !important; /* Force no wrapping */
    white-space: nowrap; /* Prevent text within labels/etc from wrapping */
}

/* Adjust spacing for Bold/Italic/Color Picker */
.style-options {
    gap: 10px !important; /* Adjusted gap */
    margin-left: 10px !important; /* Adjusted margin */
    padding: 0 5px; /* Add padding for breathing room */
}
.style-options label {
    margin-right: 0px; /* Remove extra margin */
    display: inline-flex; /* Align checkbox and text */
    align-items: center;
}
.style-options input[type="checkbox"] {
    margin-right: 3px; /* Space between checkbox and text */
}

/* Style Lat/Long display below map */
#latLongDisplay {
    font-size: 1.1em !important; /* Slightly larger */
    color: red !important;
    font-weight: bold;
    margin-top: 8px !important;
    margin-bottom: 15px !important; /* Add space below */
}

/* Style SAVE button */
.save-button {
    background-color: #28a745 !important; /* Green */
    color: white !important; /* Ensure text is white */
}

/* Remove extra space above Output Dimensions (adjust margin on previous element if needed) */
.grouped-sections-container > .input-section:first-child {
     margin-top: 0; /* Example: Adjust margin if the label is the first child */
     padding-top: 0;
}
.dpi-options {
    margin-bottom: 15px; /* Add space below DPI */
}

/* Style Font Family Options (Basic - Won't show actual font) */
/* For actual font preview, JS is needed */
select.font-family-select option[value="Dancing Script"] { font-style: italic; /* Example */ }
select.font-family-select option[value="Abril Fatface"] { font-weight: bold; /* Example */ }
